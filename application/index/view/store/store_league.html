<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <!-- 屏幕适配 -->
    <script src="__STATIC__/index/js/adaptation.js"></script>
    <link rel="stylesheet" href="__STATIC__/index/css/common.css">
    <link rel="stylesheet" href="__STATIC__/index/css/store/store_league.css">
    <!-- 三级城市 -->
    <link rel="stylesheet" href="__STATIC__/index/js/plugin/threecity/css/scs.min.css">
    <title>我要加盟</title>
</head>
<body>
    <div class="wrapper">
        <header class="header">
            <a href="my_index" class="spr icon-back"></a>
            <h3 class="header-title">加盟信息</h3>
        </header>
        <div class="info-list-box">
            <ul class="list-ul">
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>店铺名称</p>
                    <input type="text" placeholder="请输入店铺名称" class="text-input shop-name">
                </li>
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>负责人姓名</p>
                    <input type="text" placeholder="请输入负责人姓名" class="text-input name">
                </li>
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>手机号</p>
                    <input type="text" placeholder="请输入手机号" class="text-input phone">
                </li>
                <li class="list-li">
                    <p class="list-title-p">座机号码</p>
                    <input type="text" placeholder="请输入座机号码" class="text-input seat-phone">
                </li>
                <li class="list-li sex-li">
                    <p class="list-title-p"><i class="must">*</i>性别</p>
                    <div class="sex-box">
                        <input type="radio" name="sex" id="male" checked class="radio-input">
                        <label for="male" class="male-label">男</label>
                        <input type="radio" name="sex" id="female" class="radio-input">
                        <label for="female">女</label>
                    </div>
                </li>
                <li class="list-li">
                    <p class="list-title-p">店铺logo</p>
                    <a href="javascript:;" class="spr icon-more"></a>
                    <img src="__STATIC__/index/image/avatar.png" class="logo-img" id="logo-img">
                    <input type="file" class="file-input upload-input" id="upload-input">
                </li>
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>营业时间</p>
                    <input type="text" value="00:00 -- 24:00" readonly class="text-input bussi-time">
                </li>
                <li class="list-li business-li" style="display:none;">
                    <p class="list-title-p">经营范围</p>
                    <a href="javascript:;" class="spr icon-more"></a>
                </li>
                <li class="list-li business-area">
                    <p class="list-title-p"><i class="must">*</i>店铺所在区域</p>
                    <a href="javascript:;" class="spr icon-more"></a>
                    <input type="text" readonly id="myAddrs" name="addr" class="text-input">
                </li>
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>店铺详细地址</p>
                    <input type="text" placeholder="请输入详细地址" class="text-input detail-addr">
                </li>
                <li class="list-li">
                    <p class="list-title-p">店铺信息</p>
                    <!-- <a href="javascript:;" class="spr icon-more"></a> -->
                    <input type="text" placeholder="请输入店铺信息" class="text-input shop-info">
                </li>
                <li class="list-li">
                    <p class="list-title-p">邮箱</p>
                    <input type="text" placeholder="请输入邮箱" class="text-input email">
                </li>
                <li class="list-li">
                    <p class="list-title-p">绑定微信</p>
                    <input type="text" placeholder="请输入微信号" class="text-input wechat">
                </li>
                <li class="list-li">
                    <p class="list-title-p"><i class="must">*</i>我要加盟</p>
                    <div class="league-box">
                        <!-- <input type="radio" name="league" id="accessory-dealer" checked class="radio-input">
                        <label for="accessory-dealer" class="accessory-dealer-label">配件商</label> -->
                    </div>
                </li>
            </ul>
            <button class="next-button"></button>
        </div>
        <div class="mask" style="display: none;"></div>
        <!-- 经营范围弹窗 -->
        <div class="business-pop">
            <header class="business-header">
                <h3 class="business-title">选择经营范围</h3>
            </header>
            <p class="business-tips">(说明：该项为多选项可多选)</p>
            <div class="business-range-box">
                <ul class="business-range-ul">
                    <!-- <li class="business-range-li">
                        <input type="checkbox" class="checkbox-input" id="checkbox-input1">
                        <label for="checkbox-input1">洗车</label>
                    </li> -->
                </ul>
            </div>
            <div class="business-btn-box">
                <button class="business-btn business-btn-cancel">取消</button>
                <button class="business-btn business-btn-confirm">确定</button>
            </div>
        </div>
    </div>
    <script src="__STATIC__/index/js/plugin/jquery.js"></script>
    <!-- 三级城市脚本 start -->
    <script src="__STATIC__/index/js/plugin/threecity/js/jquery.scs.min.js"></script>
    <script src="__STATIC__/index/js/plugin/threecity/js/CNAddrArr.min.js"></script>
    <!-- 三级城市脚本 end -->
    <script src="__STATIC__/index/js/plugin/layer.js"></script>
    <script src="__STATIC__/index/js/store_league.js"></script>
    <script>
        $(function() {
            function getAddrsArrayById(id) {
                var results = [];
                if (addr_arr[id] != undefined)
                    addr_arr[id].forEach(function(subArr) {
                        results.push({
                            key: subArr[0],
                            val: subArr[1]
                        });
                    });
                else {
                    return;
                }
                return results;
            }        
            function getStartIndexByKeyFromStartArr(startArr, key) {
                var result = 0;
                if (startArr != undefined)
                    startArr.forEach(function(obj, index) {
                        if (obj.key == key) {
                            result = index;
                            return false;
                        }
                    });
                return result;
            }
            //bind the click event for 'input' element
            $("#myAddrs").click(function() {
                var PROVINCES = [],
                    startCities = [],
                    startDists = [];
                //Province data，shall never change.
                addr_arr[0].forEach(function(prov) {
                    PROVINCES.push({
                        key: prov[0],
                        val: prov[1]
                    });
                });
                //init other data.
                var $input = $(this),
                    dataKey = $input.attr("data-key"),
                    provKey = 1, //default province 北京
                    cityKey = 36, //default city 北京
                    distKey = 37, //default district 北京东城区
                    distStartIndex = 0, //default 0
                    cityStartIndex = 0, //default 0
                    provStartIndex = 0; //default 0

                if (dataKey != "" && dataKey != undefined) {
                    var sArr = dataKey.split("-");
                    if (sArr.length == 3) {
                        provKey = sArr[0];
                        cityKey = sArr[1];
                        distKey = sArr[2];

                    } else if (sArr.length == 2) { //such as 台湾，香港 and the like.
                        provKey = sArr[0];
                        cityKey = sArr[1];
                    }
                    startCities = getAddrsArrayById(provKey);
                    startDists = getAddrsArrayById(cityKey);
                    provStartIndex = getStartIndexByKeyFromStartArr(PROVINCES, provKey);
                    cityStartIndex = getStartIndexByKeyFromStartArr(startCities, cityKey);
                    distStartIndex = getStartIndexByKeyFromStartArr(startDists, distKey);
                }
                var navArr = [{
                    title: "省",
                    id: "scs_items_prov"
                }, {
                    title: "市",
                    id: "scs_items_city"
                }, {
                    title: "区",
                    id: "scs_items_dist"
                }];
                SCS.init({
                    navArr: navArr,
                    onOk: function(selectedKey, selectedValue) {
                        $input.val(selectedValue).attr("data-key", selectedKey);
                    }
                });
                var distScroller = new SCS.scrollCascadeSelect({
                    el: "#" + navArr[2].id,
                    dataArr: startDists,
                    startIndex: distStartIndex
                });
                var cityScroller = new SCS.scrollCascadeSelect({
                    el: "#" + navArr[1].id,
                    dataArr: startCities,
                    startIndex: cityStartIndex,
                    onChange: function(selectedItem, selectedIndex) {
                        distScroller.render(getAddrsArrayById(selectedItem.key), 0); //re-render distScroller when cityScroller change
                    }
                });
                var provScroller = new SCS.scrollCascadeSelect({
                    el: "#" + navArr[0].id,
                    dataArr: PROVINCES,
                    startIndex: provStartIndex,
                    onChange: function(selectedItem, selectedIndex) { //re-render both cityScroller and distScroller when provScroller change
                        cityScroller.render(getAddrsArrayById(selectedItem.key), 0);
                        distScroller.render(getAddrsArrayById(cityScroller.getSelectedItem().key), 0);
                    }
                });
            });
        });
        // var citypicker = new CityPicker({
        //     inputId: 'area-li',
        //     data: city, // 符合格式的数组
        //     cancel: function () {
        //         console.log('取消城市选择');
        //     },
        //     initialOption: ['广东', '深圳', '福田区'],
        //     success: function(arr) {
        //         console.log(arr);
        //         console.log(arr);
        //         var arr2 = [];
        //         arr.forEach(function(val) {
        //             arr2.push(val.value);
        //         });
        //         document.getElementById('area-li').value = arr2;
        //     }
        // });
    </script>
</body>
</html>